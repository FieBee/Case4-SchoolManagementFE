<!DOCTYPE html>
<html lang="en">
<head>
    <!-- basic -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- mobile metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1">
    <!-- site metas -->
    <title>selo</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- bootstrap css -->
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <!-- style css -->
    <link rel="stylesheet" href="../css/style.css">
    <!-- Responsive-->
    <link rel="stylesheet" href="../css/responsive.css">
    <!-- fevicon -->
    <link rel="icon" href="images/fevicon.png" type="image/gif" />
    <!-- Scrollbar Custom CSS -->
    <link rel="stylesheet" href="../css/jquery.mCustomScrollbar.min.css">
    <!-- Tweaks for older IEs-->
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css" media="screen">
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
    <link href='https://css.gg/chevron-down-o.css' rel='stylesheet'>
    <script src="https://kit.fontawesome.com/78bb747893.js" crossorigin="anonymous"></script>


    <script
            src="https://code.jquery.com/jquery-3.3.1.js"
            integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
            crossorigin="anonymous">
    </script>

    <script>
        $(function () {
            $("#header").load("fragment/header.html");
            $("#footer").load("fragment/footer.html");
            // checkLogin();
        });


        function update(){
            alert("Đang bảo trì!!")
        }


        //chi tiet course
        function searchCourse(element){

            let search= element.getAttribute("href");
            console.log(search)
            $.ajax({
                headers:{
                    'Accept':'application/json',
                    'Content-Type': 'application/json'
                },
                type:"GET",
                url: `http://localhost:8080/course/${search}`,

                success:function (data){

                    let str =
                    "<div style='float: left; height:250px' class=\"col-8\">\n" +
                    "<div class=\"item-restaurant-row\" style=\"height: 0px; left: 0px;  width: 100%;\">\n" +
                    "        <div style='padding-left: 250px' class=\"row\">\n" +
                    "            <div class=\"col-auto item-restaurant-img\">\n" +
                    "                <img src=\"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS3054aAwgy_5J00ygoxXaJRms0M9trMZutvKkyBJJU2ZUWqvHhPMBvB8Q0Z6VZMb5_cXc&usqp=CAU\" alt=\"Bánh hỏi heo quay Chả Giò\" width=\"200\" height=\"200\">\n" +
                    "                </button>\n" +
                    "            </div>\n" +
                    "            <div class=\"col item-restaurant-info\">\n" +
                    "                <h2 class=\"item-restaurant-name\"> "+ data.term +"</h2>\n" +
                    "                <div class=\"item-restaurant-desc\">"+data.description+"</div>\n <i   style='color: #ffffff; background: #38e710' class=\"gg-chevron-down-o\"></i>" +
                    "            </div>\n" +
                    "            <div class=\"col-auto item-restaurant-more\">\n" +
                    "                <div class=\"row \">\n" +
                    "                    <div class=\"col-auto product-price\">\n" +
                    "                        <div class=\"current-price\">"+data.price+"<span style=\"font-weight: bolder;position: relative;top: -9px;font-size: 10px;right: 0;\">đ</span></div>\n" +
                    "                    </div>\n" +
                    "                </div>\n" +
                    "            </div>\n" +
                    "        </div>\n" +
                    "    </div></a>\n " +
                    "</div>" +
                        "<div ><div style='margin-left: 200px' class=\"\">\n" +
                        "<div id=\"\">\n" +
                        "<div class=\"\">\n" +
                        "<section class=\"\">\n" +
                        "<div class=\"\">\n" +
                        "</div>\n" +
                        "<div class=\"\">\n" +
                        "<form action=\"https://www.vnjpclub.com/minna-no-nihongo-1998/\" method=\"post\" name=\"adminForm\" id=\"adminForm\">\n" +
                        "<table class=\"\">\n" +
                        "<tbody>\n" +
                        "<tr class=\"\">\n" +
                        "<td style='text-align: center' >\n" +
                        "<a onclick='update()' href='#' >\n" +
                        "\t\t\t\t\t\t\t\tBài- (01) - はじめまして\t\t\t\t\t\t\t</a>\n" +
                        "</td>\n" +
                        "</tr>\n" +
                        "<tr class=\"cat-list-row1\">\n" +
                        "<td style='text-align: center' >\n" +
                        "<a onclick='update()' href='#' >\n" +
                        "\t\t\t\t\t\t\t\tBài- (02) - ほんの気持ちです\t\t\t\t\t\t\t</a>\n" +
                        "</td>\n" +
                        "</tr>\n" +
                        "<tr class=\"cat-list-row0\">\n" +
                        "<td style='text-align: center' >\n" +
                        "<a onclick='update()' href='#' >\n" +
                        "\t\t\t\t\t\t\t\tBài- (03) - これをください\t\t\t\t\t\t\t</a>\n" +
                        "</td>\n" +
                        "</tr>\n" +
                        "<tr class=\"cat-list-row1\">\n" +
                        "<td style='text-align: center' >\n" +
                        "<a onclick='update()' href='#' >\n" +
                        "\t\t\t\t\t\t\t\tBài- (04) - そちらは何時から何時までですか\t\t\t\t\t\t\t</a>\n" +
                        "</td>\n" +
                        "</tr>\n" +
                        "<tr class=\"cat-list-row0\">\n" +
                        "<td style='text-align: center' >\n" +
                        "<a onclick='update()' href='#' >\n" +
                        "\t\t\t\t\t\t\t\tBài- (05) - 甲子園へ行きますか\t\t\t\t\t\t\t</a>\n" +
                        "</td>\n" +
                        "</tr>\n" +
                        "<tr class=\"cat-list-row1\">\n" +
                        "<td style='text-align: center' >\n" +
                        "<a onclick='update()' href='#' >\n" +
                        "\t\t\t\t\t\t\t\tBài- (06) - いっしょにいきませんか\t\t\t\t\t\t\t</a>\n" +
                        "</td>\n" +
                        "</tr>\n" +
                        "<tr class=\"cat-list-row0\">\n" +
                        "<td style='text-align: center' >\n" +
                        "<a onclick='update()' href='#' >\n" +
                        "\t\t\t\t\t\t\t\tBài- (06B)- Kiểm tra \t\t\t\t\t\t\t</a>\n" +
                        "</td>\n" +
                        "</tr>\n" +
                        "<tr class=\"cat-list-row1\">\n" +
                        "<td style='text-align: center' >\n" +
                        "<a onclick='update()' href='#' >\n" +
                        "\t\t\t\t\t\t\t\tBài- (07) - ごめんください\t\t\t\t\t\t\t</a>\n" +
                        "</td>\n" +
                        "</tr>\n" +
                        "<tr class=\"cat-list-row0\">\n" +
                        "<td style='text-align: center' >\n" +
                        "<a onclick='update()' href='#' >\n" +
                        "\t\t\t\t\t\t\t\tBài- (08) - そろそろ失礼します\t\t\t\t\t\t\t</a>\n" +
                        "</td>\n" +
                        "</tr>\n" +
                        "<tr class=\"cat-list-row1\">\n" +
                        "<td style='text-align: center' >\n" +
                        "<a onclick='update()' href='#' >\n" +
                        "\t\t\t\t\t\t\t\tBài- (09) - 残念です\t\t\t\t\t\t\t</a>\n" +
                        "</td>\n" +
                        "</tr>\n" +
                        "<tr class=\"cat-list-row0\">\n" +
                        "<td style='text-align: center' >\n" +
                        "<a onclick='update()' href='#' >\n" +
                        "\t\t\t\t\t\t\t\tBài- (10) - チリソースがありませんか\t\t\t\t\t\t\t</a>\n" +
                        "</td>\n" +
                        "</tr>\n" +
                        "</tbody>\n" +
                        "</table>\n" +
                        "</form>\n" +
                        "</div>\n" +
                        "</section>\n" +
                        "</li></ul>\n" +
                        "</div>\n" +
                        "</div><!-- end ampz inline_bottom -->\n" +
                        "</div>\n" +
                        "</div>\n" +
                        "</div></div>"


                    document.getElementById('courseList').innerHTML = str;
                }
            })
            event.preventDefault();
        }


        function courseNotYet(element){

            let search= element.getAttribute("href");
            console.log(search)
            $.ajax({
                headers:{
                    'Accept':'application/json',
                    'Content-Type': 'application/json'
                },
                type:"GET",
                url: `http://localhost:8080/course/${search}`,

                success:function (data){

                    localStorage.setItem("paymentPrice",data.price)
                    let str =
                        "<div style='float: left; height:250px' class=\"col-8\">\n" +
                        "<div class=\"item-restaurant-row\" style=\"height: 0px; left: 0px;  width: 100%;\">\n" +
                        "        <div style='padding-left: 250px' class=\"row\">\n" +
                        "            <div class=\"col-auto item-restaurant-img\">\n" +
                        "                <img src=\"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS3054aAwgy_5J00ygoxXaJRms0M9trMZutvKkyBJJU2ZUWqvHhPMBvB8Q0Z6VZMb5_cXc&usqp=CAU\" alt=\"Bánh hỏi heo quay Chả Giò\" width=\"200\" height=\"200\">\n" +
                        "                </button>\n" +
                        "            </div>\n" +
                        "            <div class=\"col item-restaurant-info\">\n" +
                        "                <h2 class=\"item-restaurant-name\"> "+ data.term +"</h2>\n" +
                        "                <div class=\"item-restaurant-desc\">"+data.description+"</div>\n " +
                        "            </div>\n" +
                        "            <div class=\"col-auto item-restaurant-more\">\n" +
                        "                <div class=\"row \">\n" +
                        "                    <div class=\"col-auto product-price\">\n" +
                        "                        <div class=\"current-price\">"+data.price+"<span style=\"font-weight: bolder;position: relative;top: -9px;font-size: 10px;right: 0;\">đ</span></div>\n" +
                        "                        <div><button onclick='buidCourse(this)' href='"+ data.id +"' type=\"button\" class=\"btn btn-primary\">Thanh toán</button></div> " +
                        "                   </div>\n" +
                        "                </div>\n" +
                        "            </div>\n" +
                        "        </div>\n" +
                        "    </div>" +
                        "</div> <div></div>"

                    document.getElementById('courseList').innerHTML = str;

                }
            })
            createPayment()
            event.preventDefault();
        }


        function createPayment(){
            let today = new Date()
            let alo = today.getDate()
            if (alo<10){
                alo = "0"+ today.getDate()
            }
            let date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+alo;

            let amount = localStorage.getItem("paymentPrice")

            let newPayment = {
                paymentDate: date,
                amount: amount,
                status: "Đã thanh toán"
            }
            console.log(newPayment)

            $.ajax({
                headers:{
                    'Accept':'application/json',
                    'Content-Type': 'application/json'
                },
                type:"POST",
                data: JSON.stringify(newPayment),
                url: `http://localhost:8080/payment`,

                success:function (data){
                    console.log(data.id + "dataID")
                    localStorage.setItem("paymentId", data.id)
                    // return data.id
                },
                error:function (){
                    alert("Loi create payment")
                }
            })
        }

        function buidCourse(element){

            let paymentId = localStorage.getItem("paymentId");
            let courseId= element.getAttribute("href");
            let student = JSON.parse(localStorage.getItem("student"))
            studentId = student.id
            // console.log("studentID" + studentId)
            // console.log("courseId" +courseId)
            $.ajax({
                headers:{
                    'Accept':'application/json',
                    'Content-Type': 'application/json'
                },
                type:"POST",
                url: `http://localhost:8080/student/addCourse/${studentId}/${courseId}`,

                success:function (data){
                    console.log(data + "ketqua")
                    alert("Mua khoá học thành công!!");
                    $.ajax({

                        headers:{
                            'Accept':'application/json',
                            'Content-Type': 'application/json'
                        },
                        type:"POST",
                        url: `http://localhost:8080/student/addPayment/${studentId}/${paymentId}`,

                        success:function (data){
                            console.log(data + "ketqua")

                        },
                        error: function (){
                            "loi add payment"
                        }
                    })

        //askdkasdkasda
        },
                error:function alo(){
                    alert("Bạn đã mua khóa học này gòyy!!")
                }
            })
            event.preventDefault();
        }




        //bug khong chuyen trang
        function getStudent(student) {
            return `<tr>
                <td >${student.firstName}</td>
                <td >${student.lastName}</td>
                <td >${student.birth}</td>
                <td >${student.address}</td>
                <td >${student.email}</td>
                <td >${student.phone}</td>
                <td >${student.active}</td>
                </tr>`
        }


        // profile
        function showProfile(){

            document.getElementById("courseList").innerHTML = "arggggelo"

            let accountname = localStorage.getItem("accountname");

            console.log(accountname);
            console.log("alosooo");
            $.ajax({
                type: "GET",
                headers: {

                    //kiểu dữ liệu nhận về
                    'Accept': 'application/json',
                    // kiểu truyền đi
                    'Content-Type': 'application/json'
                },

                url: `http://localhost:8080/student/getStudent/${accountname}`,

                //xử lý khi thành công
                success: function (data) {
                    console.log(data)
                    let str =
                        '    <tr>\n' +
                        '        <td>First Name</td>\n' +
                        '        <td>Last Name</td>\n' +
                        '        <td>Birth</td>\n' +
                        '        <td>Address</td>\n' +
                        '        <td>Email</td>\n' +
                        '        <td>Phone</td>\n' +
                        '        <td>Account</td>\n' +
                        '        <td>Password</td>\n' +
                        '        <td>Active</td>\n' +
                        '    </tr>'+
                        '    <tr>\n' +
                        '        <td>'+data.firstName+'</td>\n' +
                        '        <td>'+data.lastName+'</td>\n' +
                        '        <td>'+data.birth+'</td>\n' +
                        '        <td>'+data.address+'</td>\n' +
                        '        <td>'+data.email +'</td>\n' +
                        '        <td>'+data.phone+'</td>\n' +
                        '        <td>'+data.account+'</td>\n' +
                        '        <td>******</td>\n' +
                        '        <td>'+data.active+'</td>\n' +
                        '    </tr>'



                    event.preventDefault();
                    document.getElementById("courseList").innerHTML = str;
                }
            })
            // successHandler();
            event.preventDefault();
        }



        //khoa hoc cua hoc sinh
        function getCourse() {
            let course = new Array()
            course = JSON.parse(localStorage.getItem("course"))
            let content = ""
            for (let i = 0; i < course.length; i++) {
                content +=
                    "<div style='float: left' class=\"col-6\">\n" +
                    " <a href='"+ course[i].id +"' onclick='searchCourse(this)'>   " +
                    // " <input value='"+ course[i].id +"' id='courseId' type='hidden'>   " +
                    "<div class=\"item-restaurant-row\" style=\"height: 250px;padding-top: 20px ;margin:  0 0px 0px; left: 0px;  width: 100%;\">\n" +
                    "        <div style='padding-left: 30px' class=\"row\">\n" +
                    "            <div class=\"col-auto item-restaurant-img\">\n" +
                    "                <img src=\"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS3054aAwgy_5J00ygoxXaJRms0M9trMZutvKkyBJJU2ZUWqvHhPMBvB8Q0Z6VZMb5_cXc&usqp=CAU\" alt=\"Bánh hỏi heo quay Chả Giò\" width=\"200\" height=\"200\">\n" +
                    "                </button>\n" +
                    "            </div>\n" +
                    "            <div class=\"col item-restaurant-info\">\n" +
                    "                <h2 class=\"item-restaurant-name tenkhoahoc\"> "+ course[i].term +"</h2>\n" +
                    "                <div class=\"item-restaurant-desc\">"+course[i].description+"</div>\n  <i   style='color: #ffffff; background: #38e710' class=\"gg-chevron-down-o\"></i>" +

                    "            </div>\n" +
                    "            <div class=\"col-auto item-restaurant-more\">\n" +
                    "                <div class=\"row \">\n" +
                    "                    <div class=\"col-auto product-price\">\n" +
                    "                        <div class=\"current-price\">"+course[i].price+"<span style=\"font-weight: bolder;position: relative;top: -9px;font-size: 10px;right: 0;\">đ</span></div>\n" +
                    "                    </div>\n" +
                    "                </div>\n" +
                    "            </div>\n" +
                    "        </div>\n" +
                    "    </div></a>\n " +
                    "</div>"

            }

            return content;
            event.preventDefault();
        }


        //
        function successHandler() {
            $.ajax({
                // type: "GET",
                // url: "http://localhost:63342/Case4-FE/html/student.html?_ijt=dspb7g9k1mf9p5b4t73ld41q3t&_ij_reload=RELOAD_ON_SAVE",
                success: function (data) {
                    let content = ""
                    if (data == null) {
                        document.getElementById("courseList").innerHTML = "Bạn chưa có khoá học nào!!!";
                    } else {

                        content += getCourse();
                        document.getElementById("courseList").innerHTML = content;

                    }
                    event.preventDefault();
                }
            })
        }
        successHandler();



        function allCourse() {
            $.ajax({
                headers:{
                    'Accept':'application/json',
                    'Content-Type': 'application/json'
                },
                type:"GET",
                url: `http://localhost:8080/course`,
                success: function (data) {
                    console.log("aasdasdad")
                    let content ="";
                    if (data == null) {
                        document.getElementById("studentList").innerHTML = content;
                    } else {
                        for (let i = 0; i < data.length; i++) {
                            content +=
                            "<div style='float: left' class='col-2 item-restaurant-row'>\n" +
                                "<a s onclick='courseNotYet(this)' href='"+ data[i].id +"'" +
                                "<div style=\"width: 240px; margin: 20px 0 20px px \" class=\"item-restaurant  \">\n" +
                                "<div class=\"img-restaurant\">\n" +
                                "<img src=\"https://stickershop.line-scdn.net/stickershop/v1/product/1027471/LINEStorePC/main.png;compress=true\" class=\"\">\n" +
                                "</div>\n" +
                                "<div class=\"info-restaurant info-basic-res\">\n" +
                                "<h4 class=\"name-res\" title=\"Chốt deal quán ngon - Freeship 0đ\">" + data[i].term+"</h4>\n" +
                                "<div class=\"txt-blue font12\">" + data[i].price+"<span style=\"font-weight: bolder;position: relative;top: -9px;font-size: 10px;right: 0;\">đ</span></div>\n" +
                                " </div>\n" +
                                "</div>\n" +
                                "</a>" +
                            "</div>";
                        }
                        document.getElementById("showAllCourse").innerHTML = content;
                    }
                }
            })

        }
        allCourse();
    </script>

</head>
<!-- body -->
<body class="main-layout inner_header contact_page">
<header id="header"></header>


<div class="yellow_darkbg">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="titlepage">
                    <h2>Sờ tu đần hôm</h2>
                </div>
            </div>
        </div>
    </div>
</div>

<!--  contact -->

<div>


<br><br>
<div  >

    <div style="float: left" class="col-4 text-center ">
        <a  href="#" onclick="successHandler()"><h1 class="dichuotvao">Course Of Me</h1></a>

    </div>

    <div style="float: left" class="col-4 text-center ">
        <a href="#" onclick="showProfile()" >
            <h1 class="dichuotvao">Profile</h1></a>
    </div>

    <div style="float: left" class="col-4 text-center ">


        <a onclick="showHistory()" href="#"><h1 class="dichuotvao">History</h1></a>
    </div>
</div>




    <style>
        *{
            border-radius: 10px;
        }
        .dichuotvao:hover{
            background-color: #e88246;
            color: whitesmoke;
        }
        .item-restaurant-row:hover{
            background-color: #f1e7e7;
        }

    </style>

<br><br><br>


<div class=""><table id="courseList" class="table table-striped"></table></div>
    <div id="studentList">
<!--        <table  class="table table-striped"></table>-->
    </div>
</div>


<div class="yellow_darkbg">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="titlepage">
                    <h2>Sờ tu đần hôm</h2>
                </div>
            </div>
        </div>
    </div>
</div>

<div>
    <table >
        <tr id="showAllCourse">

        </tr>
    </table>

</div>

<!--courser-->





<!-- end contact -->
<!--  footer -->
<footer id="footer"></footer>
<!-- end footer -->
<!-- Javascript files-->
<script src="../js/jquery.min.js"></script>
<script src="../js/popper.min.js"></script>
<script src="../js/bootstrap.bundle.min.js"></script>
<script src="../js/jquery-3.0.0.min.js"></script>
<!-- sidebar -->
<script src="../js/jquery.mCustomScrollbar.concat.min.js"></script>
<script src="../js/custom.js"></script>

<script >
    function showHistory(){
        let payment = new Array()
        payment = JSON.parse(localStorage.getItem("payment"))
        console.log(payment)
        let content =
            '     <tr>\n' +
            '        <td>Payment Date</td>\n' +
            '        <td>Amount</td>\n' +
            '        <td>Status</td>\n' +
            '    </tr>'

        for (let i = 0; i < payment.length; i++) {
            content +=
                '     <tr>\n' +
                '        <td>'+ payment[i].paymentDate +'</td>\n' +
                '        <td>'+ payment[i].amount +'</td>\n' +
            '        <td>'+ payment[i].status +'</td>\n' +
            '    </tr>'
        }
        console.log(content)
        document.getElementById("courseList").innerHTML = content
        event.preventDefault();
    }
</script>
</body>
</html>